# Contributing

This document defines contribution rules for GateQA.

## Scope

- Keep runtime static-first (no backend assumptions).
- Keep filter/deep-link/progress behavior stable.
- Keep docs synchronized with code changes in the same PR.

## Branch naming

- `feat/<short-description>`
- `fix/<short-description>`
- `docs/<short-description>`
- `refactor/<short-description>`
- `chore/<short-description>`

## Commit message style

- `feat: ...`
- `fix: ...`
- `docs: ...`
- `refactor: ...`
- `chore: ...`
- `test: ...`

Rules:

- imperative verb
- lowercase summary
- one logical change per commit

## Local quality gates

Run what applies:

```bash
npm run test:unit
npm run build
npm run qa:validate-data
python -m pytest tests/answers -q
```

For perf-sensitive changes:

```bash
npm run lighthouse:mobile
```

## Required invariants

Do not merge changes that break:

- `useFilters()` remains removed; split hooks only.
- `hideSolved` and `showOnlySolved` mutual exclusion.
- `question` query param preservation on filter writes.
- subject deselect removes orphan subtopics.
- build output contains `.nojekyll` and calculator bundle.
- `vite.config.js` base path stays aligned with deploy path.

## Generated artifacts policy

### `src/generated/subtopicLookup.json`

- generated by `scripts/precompute-subtopics.mjs`
- git-ignored (`/src/generated/`)
- never hand-edit
- regenerate with `npm run precompute`

### Version bump requirements

- bump `INIT_CACHE_VERSION` in `src/services/QuestionService.js` when:
  - question source shape changes, or
  - subtopic extraction/normalization logic changes, or
  - precompute format changes
- bump `APP_VERSION` in `src/components/ProgressManager/ProgressManager.jsx` when publishing release builds that change import/export payload expectations

## High-risk files

- `src/contexts/FilterContext.jsx`
- `src/services/QuestionService.js`
- `src/services/AnswerService.js`
- `src/components/ProgressManager/ProgressManager.jsx`
- `scripts/precompute-subtopics.mjs`
- `scripts/qa/validate-data.js`

## PR template (recommended)

```markdown
## What

## Why

## How

## Validation
- [ ] npm run test:unit
- [ ] npm run build
- [ ] npm run qa:validate-data
- [ ] manual checks for impacted flows

## Risks / Follow-ups
```

## Review priorities

1. behavior regressions in filtering/deep-link/import-export
2. wrong assumptions in normalization/join/cache logic
3. stale or missing docs
4. deploy/build break risk
